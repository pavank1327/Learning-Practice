select distinct d.district,count(distinct erd.pk) as IPcount,em.empr_code
from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and em.active=1 and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join location_codes_report lr on lr.location_code=left(empr_code,2)
inner join tbllocation tbl on tbl.pk=em.region_fk and em.active = 1
inner join tblarea ta on ta.pk=tbl.tblarea_pk
inner join tblstate ts on ta.tblstate_pk=ts.pk
inner join tbldistrict d on d.tblstate_pk = ts.pk and tbl.active = 'yes'
where ts.pk=27
group by em.empr_code,d.district
union
select distinct d.district,count(distinct erd.pk) as IPcount,em.sub_code
from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and em.active=1 and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join location_codes_report lr on lr.location_code=left(sub_code,2)
inner join tbllocation tbl on tbl.pk=em.region_fk and em.active = 1
inner join tblarea ta on ta.pk=tbl.tblarea_pk
inner join tblstate ts on ta.tblstate_pk=ts.pk
inner join tbldistrict d on d.tblstate_pk = ts.pk and tbl.active = 'yes'
where ts.pk=27
group by em.sub_code,d.district;

2)
select distinct tbl1.location_name,tbl.location_name,erd.empe_name ip_name,erd.empe_ip_number insurance_no,
round(datediff(now(),epd.date_of_birth) / 365) age,epd.date_of_birth 'D.O.B',ea.mobile,edp.dependant_name DependantName,erm.relationship 'relation with IP'
from empr_master em
inner join empe_empr_details eed on eed.empr_maste	r_fk=em.pk and eed.active = 1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk AND ERD.ACTIVE = 1
inner join empe_dependant_details edp on erd.pk = edp.empe_reg_details_fk and edp.active = 1
inner join empe_relationship_master erm on erm.pk = edp.relationship_master_fk
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active = 1 
and datediff(now(),epd.date_of_birth)/365 >= 60
inner join empe_address ea on ea.empe_reg_details_fk=epd.pk and type_of_address='Present'  and ea.active = 1
inner join esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active= 'YES'
inner join esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and 
tbl1.active= 'YES' and tbl1.pk=784
where em.active=1 and date(erd.created_datetime) <= '2023-01-28'


union

select distinct tbl1.location_name,tbl.location_name,erd.empe_name ip_name,
erd.empe_ip_number insurance_no,round(datediff(now(),epd.date_of_birth) / 365) age,epd.date_of_birth 'D.O.B',ea.mobile,
edp.dependant_name DependantName,erm.relationship 'relation with IP'
from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active = 1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk AND ERD.ACTIVE = 1
inner join empe_dependant_details edp on erd.pk = edp.empe_reg_details_fk and edp.active = 1
inner join empe_relationship_master erm on erm.pk = edp.relationship_master_fk
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active = 1 
and datediff(now(),epd.date_of_birth)/365 >= 60
inner join empe_address ea on ea.empe_reg_details_fk=epd.pk and type_of_address='Present'  and ea.active = 1
inner join esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active= 'YES'
inner join esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office 
and tbl1.active= 'YES' and tbl1.pk = 784
where em.active=1 and date(erd.created_datetime) <= '2023-01-28';

3)

select distinct em.empr_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name from empr_master em
inner join empe_empr_details eed on em.pk=eed.empr_master_fk and eed.active=1 
inner join empr_factory_details efd on em.pk=efd.empr_master_fk and efd.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empr_employer_cont_details ecd on em.pk=ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.empr_code,tbl.location_name,tl.location_name

union

select distinct em.sub_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name 
from empr_subunit_details em
inner join empe_empr_details eed on em.pk=eed.empr_subunit_details_fk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk = erd.pk and erd.active=1
inner join empr_factory_details efd on em.pk = efd.empr_master_fk  and efd.active=1
inner join empr_employer_cont_details ecd on em.pk = ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.sub_code,tbl.location_name,tl.location_name;

4)

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,
case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'
OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'
when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'
or edd.gender='femal') then 'F'
end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1
and datediff(now(),edd.date_of_birth)/365 > 60
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'
inner join tblarea ta on tbl1.tblarea_pk = ta.pk
inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'
where d.pk=264 and d.tblstate_pk=105 and em.active=1

union

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,
case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'
OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'
when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'
or edd.gender='femal') then 'F'
end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1
and datediff(now(),edd.date_of_birth)/365 > 60
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'
inner join tblarea ta on tbl1.tblarea_pk = ta.pk
inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'
where d.pk=264 and d.tblstate_pk=105 and em.active=1;

5)

select empe_name ip_name,empe_ip_number ip_number,tbl.location_name branchoffice,date(erd.created_datetime) registration_date,date(erd.firstdateofapp) appointment_date,
empr_code employer,case when (gender=' ' OR gender='' OR gender='MM' OR gender=' M' OR gender='FM' OR gender='F M' OR gender='MA' OR gender='M') then 'M' 
when (gender='F' OR gender=' F' OR gender='F ' OR gender=' F ' or gender='F') then  'F'
else 'TG' end gender
from  empr_master em
inner join empe_empr_details eed on em.pk = eed.empr_master_fk  and eed.active = 1  and empr_subunit_details_fk is null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1
inner join  esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active = 'yes'
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'
where tbl1.pk = 3
group by  empe_name ,empe_ip_number ,tbl.location_name ,empr_code,
case when (gender=' ' OR gender='' OR gender='MM' OR gender=' M' OR gender='FM' OR gender='F M' OR gender='MA' OR gender='M') then 'M' 
when (gender='F' OR gender=' F' OR gender='F ' OR gender=' F ' or gender='F') then  'F'
else 'TG' end

UNION

select empe_name ip_name,empe_ip_number ip_number,tbl.location_name branchoffice,date(erd.created_datetime) registration_date,date(erd.firstdateofapp) appointment_date,
sub_code employer,case when (gender=' ' OR gender='' OR gender='MM' OR gender=' M' OR gender='FM' OR gender='F M' OR gender='MA' OR gender='M') then 'M' 
when (gender='F' OR gender=' F' OR gender='F ' OR gender=' F ' or gender='F') then  'F'
else 'TG' end gender
from  empr_subunit_details em
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk  and eed.active = 1  and empr_subunit_details_fk is not null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1
inner join  esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active = 'yes'
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'
where tbl1.pk = 3
group by  empe_name ,empe_ip_number ,tbl.location_name ,sub_code,
case when (gender=' ' OR gender='' OR gender='MM' OR gender=' M' OR gender='FM' OR gender='F M' OR gender='MA' OR gender='M') then 'M' 
when (gender='F' OR gender=' F' OR gender='F ' OR gender=' F ' or gender='F') then  'F'
else 'TG' end;

6)

select tbl.location_name,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
	OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
	when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
	or epd.gender='femal') then 'F'
	end gender,round(datediff(now(),epd.date_of_birth)/365) as age,ea.mobile as mobno from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_personal_details epd on erd.pk= epd.empe_reg_details_fk and epd.active=1 
and datediff(now(),epd.date_of_birth)/365 > 40
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'
inner join  esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office 
where tbl1.pk = 4954
group by tbl.location_name

union

select tbl.location_name,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
	OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
	when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
	or epd.gender='femal') then 'F'
	end gender,round(datediff(now(),epd.date_of_birth)/365) as age,ea.mobile as mobno from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_personal_details epd on erd.pk= epd.empe_reg_details_fk and epd.active=1 
and datediff(now(),epd.date_of_birth)/365 > 40
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'
inner join  esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk
inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office 
where tbl1.pk = 4954
group by tbl.location_name;

7)

select em.empr_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name from empr_master em
inner join empe_empr_details eed on em.pk=eed.empr_master_fk and eed.active=1 
inner join empr_factory_details efd on em.pk=efd.empr_master_fk and efd.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empr_employer_cont_details ecd on em.pk=ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.empr_code,tbl.location_name,tl.location_name

union

select em.sub_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name 
from empr_subunit_details em
inner join empe_empr_details eed on em.pk=eed.empr_subunit_details_fk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk = erd.pk and erd.active=1
inner join empr_factory_details efd on em.pk = efd.empr_master_fk  and efd.active=1
inner join empr_employer_cont_details ecd on em.pk = ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.sub_code,tbl.location_name,tl.location_name;

8)

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,

                case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'

OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'

when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'

or edd.gender='femal') then 'F'

end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,

                ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_master em

                inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1

                inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

                inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1

                and datediff(now(),edd.date_of_birth)/365 > 60

                inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'

                inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'

                inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'

    inner join tblarea ta on tbl1.tblarea_pk = ta.pk

    inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'

                                where d.pk=264 and d.tblstate_pk=105 and em.active=1

 

                union

 

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,

                case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'

OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'

when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'

or edd.gender='femal') then 'F'

end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,

                ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_subunit_details em

                inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1

                inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

                inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1

                and datediff(now(),edd.date_of_birth)/365 > 60

                inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'

                inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'

                inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'

    inner join tblarea ta on tbl1.tblarea_pk = ta.pk

    inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'

                where d.pk=264 and d.tblstate_pk=105 and em.active=1 ;

9)

select distinct d.district,count(distinct erd.pk) as IPcount,em.empr_code

from empr_master em

inner join empe_empr_details eed on eed.empr_master_fk=em.pk and em.active=1 and eed.active=1

inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

INNER join location_codes_report lr on lr.location_code=left(empr_code,2)

inner join tbllocation tbl on tbl.pk=em.region_fk and em.active = 1

inner join tblarea ta on ta.pk=tbl.tblarea_pk

inner join tblstate ts on ta.tblstate_pk=ts.pk

inner join tbldistrict d on d.tblstate_pk = ts.pk and tbl.active = 'yes'

where ts.pk=27

group by em.empr_code,d.district

union

select distinct d.district,count(distinct erd.pk) as IPcount,em.sub_code

from empr_subunit_details em

inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and em.active=1 and eed.active=1

inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

INNER join location_codes_report lr on lr.location_code=left(sub_code,2)

inner join tbllocation tbl on tbl.pk=em.region_fk and em.active = 1

inner join tblarea ta on ta.pk=tbl.tblarea_pk

inner join tblstate ts on ta.tblstate_pk=ts.pk

inner join tbldistrict d on d.tblstate_pk = ts.pk and tbl.active = 'yes'

where ts.pk=27

group by em.sub_code,d.district;

10)

select em.empr_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid) as amountpaid,
tbl.location_name,tl.location_name from empr_master em
inner join empe_empr_details eed on em.pk=eed.empr_master_fk and eed.active=1 
inner join empr_factory_details efd on em.pk=efd.empr_master_fk and efd.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empr_employer_cont_details ecd on em.pk=ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.empr_code,tbl.location_name,tl.location_name

union

select em.sub_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid) as amountpaid,
tbl.location_name,tl.location_name 
from empr_subunit_details em
inner join empe_empr_details eed on em.pk=eed.empr_subunit_details_fk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk = erd.pk and erd.active=1
inner join empr_factory_details efd on em.pk = efd.empr_master_fk  and efd.active=1
inner join empr_employer_cont_details ecd on em.pk = ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.sub_code,tbl.location_name,tl.location_name
order by amountpaid;

11)

select d.District,em.empr_code,sum(amount_paid)  contribution
from empr_master em
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and 
rm.pk=(select max(r.pk) from revenue_mc_master r where r.empr_master_fk=em.pk)
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
inner join empr_employer_cont_details eecd on  eecd.empr_master_fk = em.pk
inner join tbldistrict d on eecd.district_fk = d.pk and d.active = 'yes'
and em.active = 1 and d.pk = 277   #271,277,279,273,284,792,717,270,85,89
group by d.District,em.empr_code
union
select d.District,em.sub_code,sum(amount_paid)  contribution
from  empr_subunit_details em
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk 
and rm.pk=(select max(r.pk) from revenue_mc_master r where r.empr_subunit_details_fk=em.pk)
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
inner join empr_employer_cont_details eecd on  eecd.empr_master_fk = em.pk
inner join tbldistrict d on eecd.district_fk = d.pk and d.active = 'yes'
and em.active = 1 and d.pk = 277  #271,277,279,273,284,792,717,270,85,89
group by d.District,em.sub_code
order by contribution desc limit 2;

12)

select em.empr_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name from empr_master em
inner join empe_empr_details eed on em.pk=eed.empr_master_fk and eed.active=1 
inner join empr_factory_details efd on em.pk=efd.empr_master_fk and efd.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empr_employer_cont_details ecd on em.pk=ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.empr_code,tbl.location_name,tl.location_name

union

select em.sub_code,efd.fact_estab_name,
concat(employer_address1,employer_address2,employer_address3) as address,
ecd.pin_code,count(erd.empe_ip_number) as IPcount,sum(amount_paid),
tbl.location_name,tl.location_name 
from empr_subunit_details em
inner join empe_empr_details eed on em.pk=eed.empr_subunit_details_fk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk = erd.pk and erd.active=1
inner join empr_factory_details efd on em.pk = efd.empr_master_fk  and efd.active=1
inner join empr_employer_cont_details ecd on em.pk = ecd.empr_master_fk and ecd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=602
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and em.created_datetime between '2022-11-01 00:00:00' and '2022-11-30 23:59:59'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by efd.fact_estab_name,em.sub_code,tbl.location_name,tl.location_name;

13)

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,

                case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'

OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'

when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'

or edd.gender='femal') then 'F'

end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,

                ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_master em

                inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1

                inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

                inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1

                and datediff(now(),edd.date_of_birth)/365 > 60

                inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'

                inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'

                inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'

    inner join tblarea ta on tbl1.tblarea_pk = ta.pk

    inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'

                                where d.pk=264 and d.tblstate_pk=105 and em.active=1

 

                union

 

select erd.empe_ip_number as IPnumber, erd.empe_name as IPName, edd.dependant_name as depname,

                case when (edd.gender=' ' OR edd.gender='' OR edd.gender='MM' OR edd.gender=' M' OR edd.gender='FM'

OR edd.gender='F M' OR edd.gender='MA' OR edd.gender='M' OR edd.gender='Male') then 'M'

when (edd.gender='F' OR edd.gender=' F' OR edd.gender='F ' OR edd.gender=' F ' or edd.gender='F' OR edd.gender='female'

or edd.gender='femal') then 'F'

end gender,round(datediff(now(),edd.date_of_birth)/365) as age,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,

                ea.pincode as Pincode,ea.mobile as mobno, tbl.Location_Name as Branchoffice from empr_subunit_details em

                inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1

                inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1

                inner join empe_dependant_details edd on erd.pk=edd.empe_reg_details_fk and edd.active=1

                and datediff(now(),edd.date_of_birth)/365 > 60

                inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present'

                inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'

                inner join  esicinsurance.tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active = 'yes'

    inner join tblarea ta on tbl1.tblarea_pk = ta.pk

    inner join tbldistrict d on ta.tbldistrict_pk= d.pk and d.active='Yes'

                where d.pk=264 and d.tblstate_pk=105 and em.active=1;

13)

select em.empr_code,efd.fact_estab_name,
pd.total_empr_contr as empr_contribution ,
pd.total_ip_contr as ipcontribution ,td.district from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk 
and eed.active=1 and em.active=1
inner join empr_factory_details efd on efd.empr_master_fk=em.pk 
and efd.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk 
and erd.active=1
left join revenue_mc_master rm on rm.empr_master_fk=em.pk 
and rm.pk=(select max(r.pk) from revenue_mc_master r where r.empr_master_fk=em.pk)
and em.created_datetime between '2019-01-01 00:00:00' and '2022-12-26 23:59:59'
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk 
and ea.active=1 and ea.type_of_address='present'
inner join tbldistrict td on td.pk=ea.district and td.tblstate_pk=ea.state_master_fk 
and td.active='Yes' and td.pk=271
where td.tblstate_pk=22 and pd.total_empr_contr is not null and pd.total_ip_contr is not null 
group by em.empr_code,pd.total_empr_contr,pd.total_ip_contr 

union

select  em.sub_code,efd.fact_estab_name,
pd.total_empr_contr as empr_contribution,
pd.total_ip_contr as ipcontribution,td.district from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk 
and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empr_subunit_details_fk=erd.pk 
and erd.active=1
inner join empr_factory_details efd on efd.empr_master_fk=em.pk 
and efd.active=1
left join revenue_mc_master rm on rm.empr_master_fk=em.pk 
and rm.pk=(select max(r.pk) from revenue_mc_master r where r.empr_master_fk=em.pk)
and em.created_datetime between '2019-01-01 00:00:00' and '2022-12-26 23:59:59'
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk 
and ea.active=1 and ea.type_of_address='present'
inner join tbldistrict td on td.pk=ea.district and td.tblstate_pk=ea.state_master_fk 
and td.active='Yes' and td.pk=271
where  td.tblstate_pk=22 and pd.total_empr_contr is not null and pd.total_ip_contr is not null
group by em.sub_code,pd.total_empr_contr,pd.total_ip_contr
desc limit 2;

14)

select em.empr_code,efd.fact_estab_name as companyname,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
ifnull(ea.mobile,ea.phone_number) phone_number, tbl.location_name as 'Branch Office', 
case when type_of_address ='Present' then concat(ea.address1,ea.address2,ea.address3) end as 'presentaddress',
case when type_of_address='Permanent'then concat(ea.address1,ea.address2,ea.address3) end  as 'permanantaddress' 
from empr_master em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl.pk=tbl.Reporting_Office and tbl1.active='Yes' and tbl1.pk=5
where em.active=1
group by tbl.location_name,em.empr_code

union


select em.sub_code,efd.fact_estab_name as companyname,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
ifnull(ea.mobile,ea.phone_number) phone_number, tbl.location_name as 'Branch Office', 
case when type_of_address ='Present' then concat(ea.address1,ea.address2,ea.address3) end as 'presentaddress',
case when type_of_address='Permanent'then concat(ea.address1,ea.address2,ea.address3) end  as 'permanantaddress' 
from empr_subunit_details em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl.pk=tbl.Reporting_Office and tbl1.active='Yes' and tbl1.pk=5
where em.active=1
group by tbl.location_name,em.sub_code limit  5; 

15) (IM3064035) Insured person and dependant count attched with ESIS Dispensary Nehrunagar Indore

IPCount :

select DISPENSARY_NAME,gender,ip_count from (
select TBL.LOCATION_NAME DISPENSARY_NAME,count(distinct erd.pk) as ip_count,#count(ed.pk) as dep_count,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M') then 'M' 
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
else 'TG' end gender from esicinsurance.empr_master em
inner join empe_empr_details eed on em.pk = eed.empr_master_fk and em.active = 1 and eed.active = 1 and empr_subunit_details_fk is null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1
#inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on erd.approved_dispensary_master_fk = TBL.PK
WHERE TBL.PK = 2218
group by case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M') then 'M' 
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
else 'TG' end
union 
select TBL.LOCATION_NAME DISPENSARY_NAME,count(distinct erd.pk) as ip_count,#count(ed.pk) as dep_count,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M') then 'M' 
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
else 'TG' end gender from esicinsurance.empr_subunit_details em
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk and em.active = 1 and eed.active =1 and empr_subunit_details_fk is not null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk and  epd.active = 1
#inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on erd.approved_dispensary_master_fk = TBL.PK
WHERE TBL.PK = 2218
group by case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M') then 'M' 
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
else 'TG' end )t  group by gender;

Dep Count:

select DISPENSARY_NAME,gender,dep_count from (
select TBL.LOCATION_NAME DISPENSARY_NAME,count(ed.pk) as dep_count,
case when (ed.gender=' ' OR ed.gender='' OR ed.gender='MM' OR ed.gender=' M' OR ed.gender='FM' OR ed.gender='F M' OR ed.gender='MA' OR ed.gender='M') then 'M' 
when (ed.gender='F' OR ed.gender=' F' OR ed.gender='F ' OR ed.gender=' F ' or ed.gender='F') then  'F'
else 'TG' end gender from esicinsurance.empr_master em
inner join empe_empr_details eed on em.pk = eed.empr_master_fk and em.active = 1 and eed.active = 1 and empr_subunit_details_fk is null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on erd.approved_dispensary_master_fk = TBL.PK
WHERE TBL.PK = 2218
group by case when (ed.gender=' ' OR ed.gender='' OR ed.gender='MM' OR ed.gender=' M' OR ed.gender='FM' OR ed.gender='F M' OR ed.gender='MA' OR ed.gender='M') then 'M' 
when (ed.gender='F' OR ed.gender=' F' OR ed.gender='F ' OR ed.gender=' F ' or ed.gender='F') then  'F'
else 'TG' end
union 
select TBL.LOCATION_NAME DISPENSARY_NAME,count(ed.pk) as dep_count,
case when (ed.gender=' ' OR ed.gender='' OR ed.gender='MM' OR ed.gender=' M' OR ed.gender='FM' OR ed.gender='F M' OR ed.gender='MA' OR ed.gender='M') then 'M' 
when (ed.gender='F' OR ed.gender=' F' OR ed.gender='F ' OR ed.gender=' F ' or ed.gender='F') then  'F'
else 'TG' end gender from esicinsurance.empr_subunit_details em
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk and em.active = 1 and eed.active =1 and empr_subunit_details_fk is not null
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on erd.approved_dispensary_master_fk = TBL.PK
WHERE TBL.PK = 2218
group by case when (ed.gender=' ' OR ed.gender='' OR ed.gender='MM' OR ed.gender=' M' OR ed.gender='FM' OR ed.gender='F M' OR ed.gender='MA' OR ed.gender='M') then 'M' 
when (ed.gender='F' OR ed.gender=' F' OR ed.gender='F ' OR ed.gender=' F ' or ed.gender='F') then  'F'
else 'TG' end )t  group by gender;

16) IP Details who are above age of 40 in SRO - AlkapuriBaroda(SRO-Vadodara)
select tbl.location_name DISPENSARY_NAME,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,date(epd.date_of_birth) as DOB,round(datediff(now(),epd.date_of_birth) / 365) age,
em.empr_code as emprcode,efd.fact_estab_name as employername
from empr_master em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_master_fk and eed.active = 1 and em.active=1
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join tbllocation tbl on erd.approved_dispensary_master_fk = tbl.pk and tbl.active='Yes'
WHERE erd.approved_dispensary_master_fk in ('1906','1907','1908','1909','1910','1911','1912','1913','3192','5937')
group by erd.empe_ip_number,erd.empe_name,tbl.location_name
union 
select tbl.location_name DISPENSARY_NAME,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,date
(epd.date_of_birth) as DOB,round(datediff(now(),epd.date_of_birth) / 365) age,
em.sub_code as emprcode,efd.fact_estab_name as employername
from empr_subunit_details em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk and eed.active = 1 and em.active=1
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join tbllocation tbl on erd.approved_dispensary_master_fk = tbl.pk and tbl.active='Yes'
WHERE erd.approved_dispensary_master_fk in ('1906','1907','1908','1909','1910','1911','1912','1913','3192','5937')
group by erd.empe_ip_number,erd.empe_name,tbl.location_name;

--> to find claim count and amount for funeral and ABVKY expenses for particular period for Kerala (BO/RO/SRO)

select btm.benefit_type,tbl1.location_name 'RO/SRO',tbl.location_name 'Branchoffice',
count(bcm.pk) as claimcount,sum(paid_amount) as amount
from empe_reg_details erd  
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk=erd.pk and erd.active=1  and bcm.claim_status in (3,98)
inner join benefit_type_master btm on bcm.benefit_type_master_fk=btm.pk 
inner join benefit_payment_details bpm on bcm.pk=bpm.benefit_claim_master_fk
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl.active='YES' 
and  tbl1.active='YES'
where date(bcm.created_datetime) between '2022-01-01' and '2023-04-06'
and tbl1.pk in(787,811,836,3089,3241,788,1070,1073,1075,1077,1079,1083,1084,1087,5896,6016,6017,6018)
and  btm.pk in(1007,1012)
group by  btm.benefit_type,tbl1.location_name,tbl.location_name;

--> find the claim count and amount for the benefittypes for the particular period in Kerala(BO/RO/SRO) wise

use esicinsurance;
select btm.benefit_type,bst.benefit_sub_type_name,tbl1.location_name 'RO/SRO',tbl.location_name 'BranchOffice',
count(bcm.pk) as claimcount,sum(paid_amount) as amount
from empe_reg_details erd  
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk=erd.pk and erd.active=1  and bcm.claim_status in (3,98)
inner join benefit_type_master btm on bcm.benefit_type_master_fk=btm.pk 
inner join benefit_sub_type bst on bst.benefit_type_master_fk=btm.pk
inner join benefit_payment_details bpm on bcm.pk=bpm.benefit_claim_master_fk
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl.active='YES' and tbl1.active='YES'
where date(bcm.created_datetime) between '2022-01-01' and '2023-04-06'
and tbl1.pk in(787,811,836,3089,3241,788,1070,1073,1075,1077,1079,1083,1084,1087,5896,6016,6017,6018)
and  (btm.pk in(1001,1003,1004,1000,1006,1007,1012) and
bst.pk in(2014,2015,2008,2009,2000,2001,2003,2005,2006,2019,2024,2025,2026,2018,2022,2023))
group by  btm.benefit_type,bst.benefit_sub_type_name,tbl1.location_name,tbl.location_name;

-->  IPcount of particular dispensaries

select tbl.location_name,count(erd.empe_ip_number) as IPCount from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1 
and date(erd.created_datetime) <= '2023-02-19'
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where em.active=1 and erd.approved_dispensary_master_fk in (1972,1966)
group by tbl.location_name

union

select tbl.location_name,count(erd.empe_ip_number) as IPCount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
and date(erd.created_datetime) <= '2023-02-19'
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where em.active=1 and erd.approved_dispensary_master_fk in (1972,1966)
group by tbl.location_name;

--> Employer Contribution of SRO - Nagpur

 select efd.fact_estab_name
Employer_name,em.empr_code,em.created_datetime,concat(employer_address1,employer_address2,employer_address3) as 'Address',
tbl.location_name,tl.location_name,sum(amount_paid) amnt_paid
from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and eed.empr_subunit_details_fk is null
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and em.active=1 and efd.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='yes' and tbl.pk=601
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and date(em.created_datetime) <= '2023-02-20'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by fact_estab_name,empr_code,tbl.location_name,tl.location_name

union
select efd.fact_estab_name Employer_name,em.sub_code,em.created_datetime,concat(employer_address1,employer_address2,employer_address3) as Address,
tbl.location_name,tl.location_name, sum(amount_paid) amnt_paid
from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 and eed.empr_subunit_details_fk is not null
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and em.active=1 and efd.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
inner join empe_reg_details erd on erd.pk=eed.empe_reg_details_fk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active= 'yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active= 'yes' and tbl.pk=601
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and date(em.created_datetime) <= '2023-02-20'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by fact_estab_name,sub_code,tbl.location_name,tl.location_name;

--> IP count of BO - Dalmianagar
select tbl.Location_Code,tbl.location_name,count(erd.empe_ip_number) as IPcount from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 and erd.registration_status_fk=1
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes' and tbl.pk=2941
where em.active=1 and date(erd.created_datetime) < '2022-03-31' 
group by tbl.location_name

union 

select tbl.Location_Code,tbl.location_name,count(erd.empe_ip_number) as IPcount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 and erd.registration_status_fk=1
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes' and tbl.pk=2941
where em.active=1 and date(erd.created_datetime) < '2022-03-31'
group by tbl.location_name;

--> Claim count and amount of all benefit types for particular period

select btm.benefit_type,bst.benefit_sub_type_name,tbl1.location_name 'RO/SRO',tbl.location_name 'Branchoffice',
count(bcm.pk) as claimcount,sum(paid_amount) as amount
from empe_reg_details erd  
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk=erd.pk and erd.active=1  and bcm.claim_status in (3,98)
inner join benefit_type_master btm on bcm.benefit_type_master_fk=btm.pk
inner join benefit_sub_type bst on bst.benefit_type_master_fk=btm.pk
inner join benefit_payment_details bpm on bcm.pk=bpm.benefit_claim_master_fk
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl.active='YES' 
and  tbl1.active='YES'
where date(bcm.created_datetime) between '2022-04-01' and '2023-02-28'
and  btm.pk in(1001,1003,1004,1000,1006,1007) and 
bst.pk in(2014,2015,2008,2009,2000,2001,2003,2005,2006,2019,2024,2025,2026,2018,2022,2023)
group by  btm.benefit_type,bst.benefit_sub_type_name,tbl1.location_name,tbl.location_name;	

--> IP's and IW's of age 40 and above of SRO - Udaipur region

select erd.empe_ip_number as IPNumber,erd.empe_name as IPName,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
ifnull(ea.mobile,ea.phone_number) phone_number,round(datediff(now(),epd.date_of_birth)/365) as age from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.type_of_address='Present'
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active='Yes' 
where tbl1.pk=1117 and em.active=1

union

select erd.empe_ip_number as IPNumber,erd.empe_name as IPName,concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
ifnull(ea.mobile,ea.phone_number) phone_number,round(datediff(now(),epd.date_of_birth)/365) as age from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.type_of_address='Present'
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active='Yes' 
where tbl1.pk=1117 and em.active=1;

--> IP Count of SRO - Ludhiana

select tbl.location_name,count(erd.empe_ip_number) as IPcount
from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1 
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.reporting_office and tbl.active='Yes' and tbl.pk=817
where em.active=1 
union 
select tbl.location_name,count(erd.empe_ip_number) as IPcount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1 
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.reporting_office and tbl.active='Yes' and tbl.pk=817
where em.active=1;

--> IP Count of SRO - Vadodara (SRO - alkapuri baroda)

select tbl1.location_name,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,round(datediff(now(),epd.date_of_birth) / 365) age,
em.empr_code as emprcode,efd.fact_estab_name as employername
from empr_master em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_master_fk and eed.active = 1 
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 > 40
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl.Reporting_Office=tbl1.pk and tbl1.active='Yes' 
WHERE tbl1.pk=688 and em.active=1 
group by tbl.location_name
union 
select tbl.location_name,erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
round(datediff(now(),epd.date_of_birth) / 365) age,
em.sub_code as emprcode,efd.fact_estab_name as employername
from empr_subunit_details em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk and eed.active = 1 
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 > 40
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl.Reporting_Office=tbl1.pk and tbl1.active='Yes' 
WHERE tbl1.pk=688 and em.active=1 
group by tbl.location_name;

--> State wise employer count from particular period

select ts.State_Name,count(em.pk) as employercount from tblarea ta
inner join tbldistrict td  on ta.tbldistrict_pk=td.pk
inner join tblstate ts on td.tblstate_pk=ts.pk
inner join tbllocation tbl on tbl.tblarea_pk=ta.pk and tbl.active='YES'
inner join empr_master em on em.branch_office_fk=tbl.pk 
inner join location_codes_report lr on lr.location_code=left(em.empr_code,2)
inner join registration_status_master rsm on rsm.pk=em.registration_status_fk where em.registration_status_fk = 10
and date(em.updated_datetime) between '2020-01-01' and '2021-12-31' 
group by ts.State_Name
union 
select ts.State_Name,count(em.pk) as employercount from tblarea ta
inner join tbldistrict td  on ta.tbldistrict_pk=td.pk
inner join tblstate ts on td.tblstate_pk=ts.pk
inner join tbllocation tbl on tbl.tblarea_pk=ta.pk and tbl.active='YES'
inner join empr_subunit_details em on em.branch_office_fk=tbl.pk 
inner join location_codes_report lr on lr.location_code=left(em.sub_code,2)
inner join registration_status_master rsm on rsm.pk=em.reg_status_fk where em.reg_status_fk = 10
and date(em.updated_datetime) between '2020-01-01' and '2021-12-31' 
group by ts.State_Name;
  
--> IP's and IW's of age 40 and above of Uttarkhand region

select erd.empe_ip_number as IPnumber,erd.empe_name as IPname,date(epd.date_of_birth) as DOB,round(datediff(now(),epd.date_of_birth) / 365) age,
ifnull(ea.mobile,ea.phone_number) phone_number,tbl.location_name as 'Branchoffice',em.empr_code as emprcode,
efd.fact_estab_name as employername
from empr_master em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_master_fk and eed.active = 1 and em.active=1
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present' 
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.Reporting_office and tbl1.active='Yes' and tbl1.pk=796
where em.active=1
group by tbl.location_name,em.empr_code

union

select erd.empe_ip_number as IPnumber,erd.empe_name as IPname,date(epd.date_of_birth) as DOB,round(datediff(now(),epd.date_of_birth) / 365) age,
ifnull(ea.mobile,ea.phone_number) phone_number,tbl.location_name as 'Branchoffice',em.sub_code as emprcode,
efd.fact_estab_name as employername
from empr_subunit_details em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empe_empr_details eed on em.pk = eed.empr_subunit_details_fk and eed.active = 1 and em.active=1
inner join empe_reg_details erd on erd.pk = eed.empe_reg_details_fk and erd.active = 1
inner join empe_personal_details epd on erd.pk = epd.empe_reg_details_fk  and epd.active = 1 and datediff(now(),epd.date_of_birth)/365 >= 40
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and type_of_address='present' 
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.Reporting_office and tbl1.active='Yes' and tbl1.pk=796
where em.active=1
group by tbl.location_name,em.sub_code;

-->Count of Employees who are normal contributors for the month of December 2022 under SRO Ernakulam

select tbl.location_name, count(erd.pk) as IPcount from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes' and tbl.pk=811
left join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk) and date(em.created_datetime) between '01-12-2022' and '31-12-2022'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by tbl.location_name
union
select tbl.location_name, count(erd.pk) as IPcount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes' and tbl.pk=811
left join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and date(em.created_datetime) between '01-12-2022' and '31-12-2022'
left join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
left join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by tbl.location_name;
 
-- IP Count of all regions for particular dates

select tbl.location_name as location,count(erd.empe_ip_number) as IPcount from empe_reg_details erd
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes'
where erd.active=1 and date(erd.created_datetime) between '2022-11-01' and '2022-11-30'
group by tbl.location_name;

(or)

select tbl.location_name as location,count(erd.empe_ip_number) as IPcount from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes'
where em.active=1 and date(erd.created_datetime) between '2022-11-01' and '2022-11-30'
group by tbl.location_name

union

select tbl.location_name as location,count(erd.empe_ip_number) as IPCount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes'
where em.active=1 and date(erd.created_datetime) between '2022-11-01' and '2022-11-30'
group by tbl.location_name;

--> IP Details of accident report claims for particular employers in particular region

use esicinsurance;
select erd.empe_ip_number IPnumber,erd.empe_name IPname
	from empe_reg_details erd
	inner join benefit_accident_report br on br.empe_reg_details_fk=erd.pk and erd.active=1
	inner join empe_empr_details eed on eed.empe_reg_details_fk=erd.pk and eed.active=1 
	inner join empr_master em on eed.empr_master_fk=em.pk and em.active=1
	inner join tbllocation tl on tl.pk=em.region_fk and tl.active='Yes'
	where em.region_fk=811 and date(br.accident_date) between '2015-01-01' and '2023-04-18'
	and em.empr_code in ('47000115620001099','47000141430000912','47000148340001018',
						'47000153970000704','47000155730001101','47000158950001102',
						'47000159320000802','47000165740001002','47000170980001302',
						'47000171160001302','47000173350001302','47000178750001302',
						'47000178820001302','47000179400000901','47000182590000005',
						'47000555640001002','47000570850001001','47000605980001002',
						'47000606000001002','47000606010001002','47000607020001101',
						'47000613850000999','47000614480000999','47000615860000003',
						'47000616560001001','47000616790001021','47000617230001399',
						'47000617540001018','47000619350001399','47000620930001002',
						'47000621840001002','47000621910000602','47000622180000999',
						'47000622880000999','47000623680001101','47000624460000606',
						'47000625240001002','47000625250001002','47000625380000999',
						'47000625500001002','47000625670001301','47000626160000999',
						'47000626170001301','47000626270000999','47000626550000999',
						'47000626780000999','47000626870000999','47000627180000999',
						'47000627210000912','47000627270000912','47000629890000999',
						'47000631520000999','47000631980000199','47000632240001101',
						'47000632460001007','47000632790001303','47000632860000999',
						'47000633530000999','47000633830000999','47000633860000999',
						'47000634120000999','47000634280000999','47000634310000999',
						'47000634320001099','47000634330001002','47000634340001002',
						'47000634400000999','47000635010001002','47000635030001002',
						'47000635050000999','47000635250000999','47000635580000999',
						'47000635590000999','47000635620000999','47000635790001002',
						'47000635830000999','47000636020000999','47000636030000999',
						'47000636040000999','47000636050000999','47000636060000999',
						'47000636110000999','47000636120000999','47000636130000999',
						'47000636140000999','47000636160000999','47000636230000999',
						'47000636310000999','47000636320000999','47000636380001099',
						'47000636390000999','47000636540000999','47000636630000999',
						'47000636640000999','47000636650000999','47000636660000999',
						'47000636710000999','47000636720000999','47000636780001007',
						'47000636800000999','47000636930000999','47000637100000999',
						'47000637110000999','47000637120000999','47000637370000999',
						'47000637380000999','47000637460000999','47000637470000999',
						'47000637480000999','47000637970000999','47000638080000999',
						'47000638090000999','47000638100000999','47000638240000999',
						'47000638250000999','47000638260000999','47000638530000999',
						'47000638540000999','47000638620000999','47000638640000999',
						'47000638650000999','47000638830000999','47000638840000999',
						'47000638850000999','47000638980000999','47000638990000999',
						'47000639060000999','47000639070000999','47000639080000999',
						'47000639110000999','47000639120000999','47000639130000999',
						'47000639460000999','47000639660000999','47000639670000999',
						'47000639680000999','47000639720000999','47000639730000999',
						'47000639980000999','47000640000000999','47000640010000999',
						'47000640740001301','47000640760001301','47000641370000999',
						'47000641880000999','47000642020000999','47000642030000999',
	'47000642380000999',
	'47000642550001301',
	'47000642690001301',
	'47000642720000999',
	'47000642780000999',
	'47000643120000999',
	'47000643190000999',
	'47000643270000999',
	'47000643280000999',
	'47000643300000999',
	'47000643480000999',
	'47000643860000999',
	'47000643910000999',
	'47000644150000999',
	'47000644190000999',
	'47000644200000999',
	'47000644210000999',
	'47000644220000999',
	'47000644250000999',
	'47000644380000999',
	'47000644490000999',
	'47000644500000999',
	'47000644510000999',
	'47000644520000999',
	'47000644530000999',
	'47000644640000999',
	'47000644730000999',
	'47000644850000999',
	'47000644860000999',
	'47000644890001301',
	'47000644940000999',
	'47000644980000999',
	'47000645090000999',
	'47000645210000999',
	'47000645220000999',
	'47000645230000999',
	'47000645240000999',
	'47000645570000999',
	'47000645580000999',
	'47000645930001301',
	'47000646040000999',
	'47000646050000999',
	'47000646060000999',
	'47000646260000999',
	'47000646480000999',
	'47000646490000999',
	'47000646500000999',
	'47000646510000999',
	'47000646530000999',
	'47000646550000999',
	'47000646570000999',
	'47000646610000999',
	'47000646630000999',
	'47000646650000999',
	'47000646660000999',
	'47000646670000999',
	'47000646990000999',
	'47000647020000999',
	'47000647200000999',
	'47000647440000999',
	'47000647500000999',
	'47000647520000999',
	'47000647530000999',
	'47000648000000999',
	'47000648020000999',
	'47000648110000999',
	'47000648550000999',
	'47000648590000999',
	'47000648600000999',
	'47000648610000999',
	'47000648710000999',
	'47000648800000999',
	'47000649750000999',
	'47000649970000999',
	'47000649980000999',
	'47000650370000999',
	'47000650380000999',
	'47000650400000999',
	'47000650720000999',
	'47000651340000999',
	'47000651350000999',
	'47000651770000999',
	'47000651780000999',
	'47000651790000999',
	'47000651810000999',
	'47000651970000999',
	'47000652280000999',
	'47000652300000999',
	'47000652620000999',
	'47000652630000999',
	'47000652640000999',
	'47000653140000999',
	'47000653310000999',
	'47000656590000999',
	'47000656600000999',
	'47000656650000999',
	'47000656850000999'
	'47000656910000999',
	'47000657090000999',
	'47000658140000999',
	'47000658270001102',
	'47000658540000999',
	'47000658960000999',
	'47000659100000999',
	'47000659110000999',
	'47000659570000999',
	'47000659650000999',
	'47000659980000999',
	'47000659990000999',
	'47000660000000999',
	'47000660010000999',
	'47000660240000999',
	'47000660250000999',
	'47000660260000999',
	'47000660480000999',
	'47000660580000999',
	'47000660680000999',
	'47000660710000999',
	'47000660720000999',
	'47000660980000999',
	'47000661130001019',
	'47000661450001019',
	'47000661590001001',
	'47000661600001001',
	'47000661610001001',
	'47000661620001001',
	'47000661630001001',
	'47000661640001001',
	'47000661930001019',
	'47000662150001019',
	'47000662170001019',
	'47000662180001019',
	'47000662190001019',
	'47000662200001019',
	'47000662230001019',
	'47000662240001001',
	'47000662360001001',
	'47000662440001019',
	'47000662450001019',
	'47000662460001019',
	'47000663090000999',
	'47000663130000999',
	'47000663250000999',
	'47000663260000999',
	'47000663300000999',
	'47000663310000999',
	'47000663390000999',
	'47000663450000999',
	'47000663650000999',
	'47000663660000999',
	'47000663870000999',
	'47000664130000999',
	'47000664140000999',
	'47000664310000999',
	'47000664370000999',
	'47000664410000999',
	'47000664650000999',
	'47000664680000999',
	'47000665180000999',
	'47000665220000999',
	'47000665410000999',
	'47000665600000999',
	'47000665610000999',
	'47000665740000999',
	'47000665980000999',
	'47000666390000999',
	'47001089930001399')
	union
	select erd.empe_ip_number IPnumber,erd.empe_name IPname
	from empe_reg_details erd
	inner join benefit_accident_report br on br.empe_reg_details_fk=erd.pk and erd.active=1
	inner join empe_empr_details eed on eed.empe_reg_details_fk=erd.pk and eed.active=1 
	inner join empr_subunit_details em on eed.empr_subunit_details_fk=em.pk and em.active=1
	inner join tbllocation tl on tl.pk=em.region_fk and tl.active='Yes'
	where em.region_fk=811 and date(br.accident_date) between '2015-01-01' and '2023-04-18'
	and em.sub_code in 
	('47470661600011001',
	'47470667150010999',
	'47470660260020999',
	'47470614280011004',
	'47470636730010204',
	'47470651840010999',
	'47470614280041004',
	'47470661930011019',
	'47470624030010699',
	'47470639670010999',
	'47470614280031004',
	'47470609700011099',
	'47470624460010606',
	'47470622140010899',
	'47470656600010999',
	'47470630920011101',
	'47470622140040899',
	'47470621910010602',
	'47470622140020899',
	'47470621820021002',
	'47470622140080899',
	'47470614280051004',
	'47470622140150899',
	'47470616530010505',
	'47470622140050899',
	'47470660260010999',
	'47470614280061004',
	'47350221870011002',
	'47350221870021002',
	'47500423230011001',
	'47540214630011099',
	'47540214630031099',
	'47540214630051099',
	'47540214630061099',
	'47470621840021002',
	'47470630070010999',
	'47470643280090999',
	'47470622140110899',
	'47470622140060899',
	'47470622140090899',
	'47470622140160899',
	'47470660260030999',
	'47470137970011002',
	'47470622140120899',
	'47470665180010999',
	'47470622140170899',
	'47470614280021004',
	'47470622140130899',
	'47470622140030899',
	'47470660260040999',
	'47470622140100899',
	'47470626370011301',
	'47470644380030999',
	'47470622140180899',
	'47470620930011002',
	'47470644380010999',
	'47470650250011099',
	'47540222750010999',
	'47540214630021099',
	'47540214630041099',
	'47470570680010399',
	'47470607740010999',
	'47470625280010999',
	'47470644380020999',
	'47470644730010999',
	'47540214630071099',
	'47340280630011001',
	'47470621840011002',
	'47470644380040999',
	'47470644380050999',
	'47540222750020999');
--> IP list and count of particular dispensaries

select distinct tbl.location_name dispensary_name,erd.empe_ip_number ip_number
FROM revenue_live_list rll 
inner join empe_reg_details erd on RLL.empe_reg_details_fk = erd.pk and erd.active = 1
inner join tbllocation tbl on erd.approved_dispensary_master_fk = tbl.pk and tbl.active='Yes'
where tbl.pk in (32201,32126)
group by tbl.location_name,erd.empe_ip_number;#and rll.avg_emp_work_days > 0;

select tbl.location_name as Dispensary,count(erd.pk) as IPcount from empe_reg_details erd
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where erd.active=1 and erd.approved_dispensary_master_fk in (2038,2040,2041,2042,2043,5750) 
#and date(erd.created_datetime) <='25-04-2023'
group by tbl.location_name;

--> IP list and dep count of particular dispensary(3204)

select tbl.location_name as Dispensary, erd.empe_ip_number as IPnumber, erd.empe_name as IPName,ifnull(ea.mobile,ea.phone_number) phone_number,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
or epd.gender='femal') then 'F' else 'TG'
end gender,count(distinct ed.pk) as dependantcount from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 and ea.type_of_address='present'
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where em.active=1 and erd.approved_dispensary_master_fk=3204
group by tbl.location_name,erd.empe_ip_number,erd.empe_name,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
or epd.gender='femal') then 'F' else 'TG' end
union
select tbl.location_name as Dispensary, erd.empe_ip_number as IPnumber, erd.empe_name as IPName,ifnull(ea.mobile,ea.phone_number) phone_number,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
or epd.gender='femal') then 'F' else 'TG'
end gender,count(distinct ed.pk) as dependantcount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 and ea.type_of_address='present'
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where em.active=1 and erd.approved_dispensary_master_fk=3204
group by tbl.location_name,erd.empe_ip_number,erd.empe_name,case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM'
OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M' OR epd.gender='Male') then 'M'
when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F' OR epd.gender='female'
or epd.gender='femal') then 'F' else 'TG' end;

-->count of year wise breakup of employer for these years  2022,2021,2020,2019,2018

 select year,sum(employer) emplyer,sum(ipcount) ip from (
select rm.mc_year year,count(distinct em.pk) employer,count( erd.pk) as IPcount  
from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes' and tbl.pk=5192
inner join revenue_mc_master rm on rm.empr_master_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_master_fk=em.pk)  and rm.mc_year in ( 2022,2021,2020,2019,2018)
inner join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
inner join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by rm.mc_year
union
select rm.mc_year year,count(distinct em.pk) employer,count( erd.pk) as IPcount from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1 
inner join tbllocation tl on tl.pk=erd.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office and tbl.active='Yes' and tbl.pk=5192
inner join revenue_mc_master rm on rm.empr_subunit_details_fk=em.pk and rm.pk=(select max(r.pk) from revenue_mc_master r
where r.empr_subunit_details_fk=em.pk) and rm.mc_year in ( 2022,2021,2020,2019,2018)
inner join revenue_mc_ip_contr_det ip on ip.mc_master_fk=rm.pk and ip.mc_type=0
inner join revenue_mc_payment_det pd on pd.monthly_cont_master_fk=rm.pk
group by rm.mc_year) k group  by year;

--> Non Complying units of chattisgarh

select DISTINCT  
em.empr_code,efd.fact_Estab_name employer_name,tbl1.location_name as Branchoffice,
concat(eed.employer_address1,eed.employer_address2,
eed.employer_address3) as address, tbld.District  district,ifnull(eed.mobile,eed.phone_number) phone_number, 
date(em.created_datetime) as  DateofRegistrationofEmployer,count(distinct erd.pk) as IPcount,
concat(rdl.defaulting_month,'-',rdl.defaulting_year) 'Date from which employer is non compliant'
from empr_master em
inner join tbllocation tbl1 on em.branch_office_fk =tbl1.pk and tbl1.active='Yes'
inner join tbllocation tbl on em.region_fk=tbl.pk and tbl.active='Yes'
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active = 1 and em.active = 1
inner join empr_employer_cont_details eed on eed.empr_master_fk=em.pk and eed.active = 1
inner join esicinsurance.revenue_defaulter_list rdl on rdl.empr_master_fk=em.pk and rdl.status=2 and empr_subunit_details_fk is null
inner join empe_empr_details ed on ed.empr_master_fk=em.pk and ed.active=1
inner join empe_reg_details erd on ed.empe_reg_details_fk=erd.pk and erd.active=1 and erd.registration_status_fk=1
inner join tblstate ts on eed.state_master_fk=ts.pk 
inner join tbldistrict tbld on eed.district_fk=tbld.pk
where tbl.pk=1114  
group by em.empr_code,tbl1.location_name

union

select DISTINCT  
em.sub_code,efd.fact_Estab_name employer_name,tbl1.location_name as Branchoffice,
concat(eed.employer_address1,eed.employer_address2,
eed.employer_address3) as address, tbld.District  district,ifnull(eed.mobile,eed.phone_number) phone_number, 
date(em.created_datetime) as  DateofRegistrationofEmployer,count(distinct erd.pk) as IPcount,
concat(rdl.defaulting_month,'-',rdl.defaulting_year) 'Date from which employer is non compliant'
from empr_subunit_details em
inner join tbllocation tbl1 on em.branch_office_fk =tbl1.pk and tbl1.active='Yes'
inner join tbllocation tbl on em.region_fk=tbl.pk and tbl.active='Yes'
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active = 1 and em.active = 1
inner join empr_employer_cont_details eed on eed.empr_master_fk=em.pk and eed.active = 1
inner join esicinsurance.revenue_defaulter_list rdl on rdl.empr_master_fk=em.pk and rdl.status=2 and empr_subunit_details_fk is not null
inner join empe_empr_details ed on ed.empr_subunit_details_fk=em.pk and ed.active=1
inner join empe_reg_details erd on ed.empe_reg_details_fk=erd.pk and erd.active=1 and erd.registration_status_fk=1
inner join tblstate ts on eed.state_master_fk=ts.pk 
inner join tbldistrict tbld on eed.district_fk=tbld.pk 
where tbl.pk=1114  
group by em.sub_code,tbl1.location_name; 

--> Regarding provide the data of online Maternity Benefit Claim Request and SB and Other Benefits from Insured person login.

use esicinsurance;
select count(bcm.pk) as Count
from mb_request_details mrd
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk =mrd.empe_reg_details_fk
inner join benefit_payment_details bpd on bpd.benefit_claim_master_fk=bcm.pk
inner join tbllocation tbl on tbl.pk=bcm.tbllocation_fk
inner join empe_reg_details erd on erd.pk=mrd.empe_reg_details_fk and erd.active=1
inner join tbllocation tblo on tblo.pk=tbl.Reporting_Office
where benefit_sub_type_fk=2005 and date(bcm.created_datetime)>='2022-07-27';

select count(bcm.pk) Count
from SB_OtherCert_request_details mrd
inner join benefit_claim_master bcm on bcm.pk =mrd.Claim_Master_Fk
inner join benefit_payment_details bpd on bpd.benefit_claim_master_fk=bcm.pk
inner join tbllocation tbl on tbl.pk=bcm.tbllocation_fk
inner join empe_reg_details erd on erd.pk=mrd.empe_reg_details_fk and erd.active=1
inner join tbllocation tblo on tblo.pk=tbl.Reporting_Office
where date(mrd.created_datetime)>='2023-02-15';

--> IP count of branch office wise in RO - rajendra place

select count(erd.empe_ip_number) as  Ip_no,tbl.Location_Name BO
from empe_reg_details erd
inner join  esicinsurance.tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='YES'
and tbl.tbllocationtype_pk=4
where tbl.pk in('101','4113','4191','4204','4220') and erd.active=1
group by tbl.Location_Name;

--> IM3148465 (Information regarding Online submission of all cash benefit including Maternity Benefit Claims and details)

select count(bcm.pk) as Count
from mb_request_details mrd
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk =mrd.empe_reg_details_fk
inner join benefit_payment_details bpd on bpd.benefit_claim_master_fk=bcm.pk
inner join tbllocation tbl1 on tbl1.pk=bcm.tbllocation_fk
inner join empe_reg_details erd on erd.pk=mrd.empe_reg_details_fk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk 
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office
where benefit_sub_type_fk=2005 and date(bcm.created_datetime)>='2022-07-27';

select count(bcm.pk) Count
from SB_OtherCert_request_details mrd
inner join benefit_claim_master bcm on bcm.pk =mrd.Claim_Master_Fk
inner join benefit_payment_details bpd on bpd.benefit_claim_master_fk=bcm.pk
inner join tbllocation tbl1 on tbl1.pk=bcm.tbllocation_fk
inner join empe_reg_details erd on erd.pk=mrd.empe_reg_details_fk and erd.active=1
inner join tbllocation tl on tl.pk=erd.branch_office_fk 
inner join tbllocation tbl on tbl.pk=tl.Reporting_Office
where date(mrd.created_datetime)>='2023-02-15'; 


--> IP details of Paramakudi, TN (ESIS Disp.) and Oddanchatram, TN (ESIS Disp.) in Dhanvantari Module

select tbl.location_name Dispensary,erd.empe_ip_number as registeredIPnumber,em.empr_code as employercode,erd.empe_uhid  
from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where erd.approved_dispensary_master_fk in (32126,32201) 
group by tbl.location_name,erd.empe_ip_number,em.empr_code

union

select tbl.location_name Dispensary,erd.empe_ip_number as MappedIPnumber,em.sub_code as employercode,erd.empe_uhid 
from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where erd.approved_dispensary_master_fk in (32126,32201) 
group by tbl.location_name,erd.empe_ip_number,em.sub_code;

IM3178136 ( Req-  for the IP Details belongs to Adyar Dispensary)

select tbl.location_name as dispensaryname, erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
date(epd.date_of_birth) as 'DOB',ifnull(ea.mobile,ea.phone_number) phone_number,count(ed.pk) as Dependantcount from empe_reg_details erd
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1 and erd.active=1
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.active=1 and ea.type_of_address='Present'
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active='Yes'
where erd.approved_dispensary_master_fk=2501
group by tbl.location_name,erd.empe_ip_number,erd.empe_name,date(epd.date_of_birth);	

IM3176592 (IP Details of RO andaman and nicobar)

select erd.empe_ip_number as IPnumber,erd.empe_name as IPname,epd.gender,
date(epd.date_of_birth) 'D.O.B',concat(ea.address1,',',ea.address2,',',ea.address3) as Address,ea.pincode as Pincode,
ea.email as Email,ifnull(ea.mobile,ea.phone_number) phone_number,d.District as district,s.State_Name as State,
ed.dependant_name as Familymembername,erm.relationship as relationshipwithIP,ed.gender,date(ed.date_of_birth) 'D.O.B' from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join empe_relationship_master erm on erm.pk = ed.relationship_master_fk
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.type_of_address='Present'
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active = 'yes'
inner join tbllocation tbl1 on tbl.reporting_office  = tbl1.pk and tbl1.active = 'yes'  
inner join tblarea ta on ta.pk=tbl.tblarea_pk
inner join tbldistrict d on ta.tbldistrict_pk = d.pk
inner join tblstate s on d.tblstate_pk = s.pk 
where tbl1.pk=4716
group by tbl.location_name,tbl1.location_name,erd.empe_ip_number,erd.empe_name

union 

select erd.empe_ip_number as IPnumber,erd.empe_name as IPname,epd.gender,
date(epd.date_of_birth) 'D.O.B',concat(ea.address1,',',ea.address2,',',ea.address3) as Address,ea.pincode as Pincode,
ea.email as Email,ifnull(ea.mobile,ea.phone_number) phone_number,d.District as district,s.State_Name as State,
ed.dependant_name as Familymembername,erm.relationship as relationshipwithIP,ed.gender,date(ed.date_of_birth) 'D.O.B' from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join empe_relationship_master erm on erm.pk = ed.relationship_master_fk
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.type_of_address='Present'
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active = 'yes'
inner join tbllocation tbl1 on tbl.reporting_office  = tbl1.pk and tbl1.active = 'yes'  
inner join tblarea ta on ta.pk=tbl.tblarea_pk
inner join tbldistrict d on ta.tbldistrict_pk = d.pk
inner join tblstate s on d.tblstate_pk = s.pk 
where tbl1.pk=4716
group by tbl.location_name,tbl1.location_name,erd.empe_ip_number,erd.empe_name;


IM3174300(Required Dump of PDB cases attached to Branch Office Jogeshwari)

select distinct(erd.empe_ip_number) as IPnumber,erd.empe_name as IPname,date(bpd.effective_start_date) as PDBCommencementdate,
bpd.pdb_rate as rateofPDB
from benefit_pdb_details BPD
inner join benefit_req_master BRM on BPD.benefit_req_master_fk=BRM.pk
inner join empe_reg_details ERD on BPD.empe_reg_details_fk=ERD.pk
inner join benefit_claim_master bcm on bcm.empe_reg_details_fk=erd.pk and bcm.claim_status in (3,98)
inner join benefit_type_master btm on bcm.benefit_type_master_fk=btm.pk 
inner join benefit_sub_type bst on bst.benefit_type_master_fk=btm.pk
inner join tbllocation tbl on erd.branch_office_fk = tbl.pk and tbl.active = 'yes'
where tbl.pk=551 and  btm.pk=1000 and
bst.pk in(2000,2001,2003,2025);

IM3169013 - Requesting list of accident reports filed by M/S Balu Engineers (63000465300000606) - reg.

select erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
concat(date(bar.accident_date),',',accident_hour) as Dateofaccident,date(bar.created_datetime) as Dateoffilingaccreport,
date(eed.appointment_date) as Dateofappointment,date(erd.created_datetime) as Dateofregistration from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
Inner Join benefit_accident_report bar on bar.empe_reg_details_fk=erd.pk
Inner Join benefit_tdb_od_det btd on btd.benefit_accident_report_fk=bar.pk
Inner Join task_details td on td.table_ref_key=btd.pk and td.active = 1
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.Reporting_Office and tbl1.active='Yes' and tbl1.pk=1120
where em.empr_code='63000465300000606'
group by erd.empe_ip_number,erd.empe_name,date(eed.appointment_date),date(erd.created_datetime);

IM3178136 ( Only Need the only July 2023 to Dec2023 benefit period IP's & their Families (Active Data), with inactive IP as well as their families.)
select distinct tbl.location_name as dispensaryname, erd.empe_ip_number as IPnumber,erd.empe_name as IPname,
concat(ea.address1,',',ea.address2,',',ea.address3) as Address,
date(epd.date_of_birth) as 'DOB',ifnull(ea.mobile,ea.phone_number) phone_number,
count(ed.pk) as Dependantcount
from revenue_live_list rll
inner join empe_reg_details erd on rll.empe_reg_details_fk = erd.pk and erd.active=0
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk
inner join empe_address ea on erd.pk=ea.empe_reg_details_fk and ea.type_of_address='Present'
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk 
inner join tbllocation tbl on tbl.pk=erd.approved_dispensary_master_fk and tbl.active= 'YES'
where erd.approved_dispensary_master_fk = 2501 and  date(benefit_start_date) >= '2023-07-01'
group by tbl.location_name,erd.empe_ip_number,erd.empe_name,date(epd.date_of_birth);

IM3180926 (Live list of Insured persons for particular dispensaries)

select tbl1.location_name as Dispensary,erd.empe_name as NameofIP,erd.empe_ip_number as IPNumber,
ifnull(ea.mobile,ea.phone_number) as Phone_number,
tbl.location_name as Branchoffice, count(ed.pk) as noofdependants from empe_reg_details erd
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.type_of_address='Present'  and ea.active=1
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1 
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=erd.approved_dispensary_master_fk and tbl1.active='Yes'
where erd.active=1 and erd.approved_dispensary_master_fk in (2532,2659,2656,2662,2841,2839)
group by tbl1.location_name,erd.empe_name,erd.empe_ip_number;

IM3201571 (AADHAAR SEEDED IP DETAILS-REQUESTED)

use esicinsurance;
select tbl1.Location_Name as Region,erd.empe_ip_number as IPNumber,erd.empe_name as IPname,ed.dependant_name as Dependantname,
date(epd.date_of_birth) as DOB,tbl.location_name as BranchOffice,date(a.Created_Datetime) as aadhaarseededdateforIP ,
date(eid.Created_Datetime) as aadhaarseededdatefordependant, 
case 
when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA' OR epd.gender='M') 
then 'M' when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
end gender
from empe_reg_ip_aadhaar_unique a
inner join  empe_reg_details erd on erd.empe_ip_number = a.IP_NUmber
inner join empe_reg_ip_aadhaar_dep eid on eid.empe_reg_details_fk=erd.pk
inner join empe_dependant_details ed on ed.empe_reg_details_fk=erd.pk and ed.active=1
inner join empe_personal_details epd on epd.empe_reg_details_fk=erd.pk and epd.active=1
inner join tbllocation tbl on erd.branch_office_fk = tbl.pk and tbl.active='Yes'
inner join  tbllocation tbl1 on tbl.Reporting_Office = tbl1.pk and tbl1.active='Yes'
where erd.active=1 and tbl1.pk = 784 
group by tbl1.Location_Name,erd.empe_ip_number,erd.empe_name,ed.dependant_name,
case when (epd.gender=' ' OR epd.gender='' OR epd.gender='MM' OR epd.gender=' M' OR epd.gender='FM' OR epd.gender='F M' OR epd.gender='MA'OR epd.gender='M') 
then 'M' when (epd.gender='F' OR epd.gender=' F' OR epd.gender='F ' OR epd.gender=' F ' or epd.gender='F') then  'F'
end;

Aadhaar details not seeded for SRO - Aurangabad 

use esicinsurance;
select tbl.location_name as locationname,em.empr_code,efd.fact_estab_name as nameoftheemployer,
count(erd.pk) IPcount
from empe_reg_details erd
inner join empe_empr_details eed on eed.empe_reg_details_fk = erd.pk and eed.active=1
inner join empr_master em on eed.empr_master_fk = em.pk and em.active=1
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join tbllocation tbl on tbl.pk=em.region_fk and tbl.active='Yes'
where  em.region_fk=603 and erd.pk not in (select (empe_reg_details_fk) from empe_reg_ip_aadhaar e )
group by tbl.location_name,em.empr_code,efd.fact_estab_name
union
select tbl.location_name as locationname,em.sub_code,efd.fact_estab_name as nameoftheemployer,
count(erd.pk) IPcount
from empe_reg_details erd
inner join empe_empr_details eed on eed.empe_reg_details_fk = erd.pk and eed.active=1
inner join empr_subunit_details em on eed.empr_subunit_details_fk = em.pk and em.active=1
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join tbllocation tbl on tbl.pk=em.region_fk and tbl.active='Yes'
where  em.region_fk=603  and erd.pk not in (select (empe_reg_details_fk) from empe_reg_ip_aadhaar e )
group by tbl.location_name,em.sub_code,efd.fact_estab_name;

IM3220685(No. of IPs attached in the IMPs and mEUD in the jurisdiction of SRO, Tirupat - Reg.)

select eim.pk,eim.imp_name,eim.imp_code,count(erd.pk) as IPCount from empe_imp_master eim
inner join empe_reg_details erd on erd.empe_imp_master_fk = eim.pk  and erd.active = 1  and eim.type in (1,2)
where eim.pk in (971,3026,969,3706) and date(erd.created_datetime) between '2023-08-01' and '2023-08-31'
group by eim.imp_code; 

IM3222560 (List of Employees registered under the jurisdiction of SRO - Kozhikode)

(i)
use esicinsurance;
select erd.empe_name, erd.empe_ip_number as IPnumber,ifnull(ea.mobile,ea.phone_number) phone_number,a.seeded as Statusofaadhaar,
em.empr_code from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 
inner join empe_reg_ip_aadhaar a on erd.empe_ip_number=a.IP_Number 
inner join tbllocation t on t.pk=erd.branch_office_fk and t.active='Yes'
inner join tbllocation tl on tl.pk=t.reporting_office and tl.active='Yes'
where tl.pk=3089
-- group by em.empr_code,erd.empe_ip_number,erd.empe_name

union

select erd.empe_name, erd.empe_ip_number as IPnumber,ifnull(ea.mobile,ea.phone_number) phone_number,a.seeded as Statusofaadhaar,
em.sub_code from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 
inner join empe_reg_ip_aadhaar a on erd.empe_ip_number=a.IP_Number 
inner join tbllocation t on t.pk=erd.branch_office_fk and t.active='Yes'
inner join tbllocation tl on tl.pk=t.reporting_office and tl.active='Yes'
where tl.pk=3089;

(ii)
use esicinsurance;
select erd.empe_name, erd.empe_ip_number as IPnumber,ifnull(ea.mobile,ea.phone_number) phone_number,
em.empr_code from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 
inner join tbllocation t on t.pk=erd.branch_office_fk and t.active='Yes'
inner join tbllocation tl on tl.pk=t.reporting_office and tl.active='Yes'
where tl.pk=3089 and erd.pk not in (select (empe_reg_details_fk) from empe_reg_ip_aadhaar e )
-- group by em.empr_code,erd.empe_ip_number,erd.empe_name

union

select erd.empe_name, erd.empe_ip_number as IPnumber,ifnull(ea.mobile,ea.phone_number) phone_number,
em.sub_code from empr_subunit_details em
inner join empe_empr_details eed on eed.empr_subunit_details_fk=em.pk and eed.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
inner join empe_address ea on ea.empe_reg_details_fk=erd.pk and ea.active=1 
 inner join tbllocation t on t.pk=erd.branch_office_fk and t.active='Yes'
inner join tbllocation tl on tl.pk=t.reporting_office and tl.active='Yes'
where tl.pk=3089 and erd.pk not in (select (empe_reg_details_fk) from empe_reg_ip_aadhaar e );

IM3219850 (Unable to download defaulter list from ERP Module...reg)

use esicinsurance;
select RDL.Empr_Code Empr_Code,
        EFD.fact_estab_name
        from revenue_defaulter_list RDL
        inner join empr_factory_details EFD on RDL.empr_master_fk=EFD.empr_master_fk
        where
        (RDL.scnid is null or  RDL.scnid=0)
        and RDL.status in (2,12,8)
        and ((substr(RDL.Empr_Code,1,2)=36) and  em_series <= (999999+1000000) and em_series >= (000001+1000000))
        group by RDL.Empr_Code
        union
        select RDL.Empr_Code Empr_Code,
        EFD.fact_estab_name
        from revenue_defaulter_list RDL
        inner join empr_subunit_details EM on RDL.empr_subunit_details_fk=EM.pk and rdl.empr_master_fk is null
        inner join empr_factory_details EFD on EM.empr_master_fk=EFD.empr_master_fk
        where
        (RDL.scnid is null or  RDL.scnid=0)
        and RDL.status in (2,12,8)
        and (( substr(RDL.Empr_Code ,1,2)=36) and  em_series <= (999999+1000000) and em_series >= (000001+1000000))
        group by RDL.Empr_Code;

IM3229178 (Need list of all accident reports filed by M/S UNIQUE MANAGEMENT MANPOWER SERVICE (63001048670000606) - reg.)

select em.empr_code,erd.empe_ip_number as IPNumber,erd.empe_name as IPName,concat(date(bar.accident_date),',',accident_hour) as Dateofaccident,
date(bar.created_datetime) as Dateoffilingaccidentreport,date(eed.appointment_date) as Dateofappointment,
date(erd.created_datetime) as Dateofregistration from empr_master em
inner join empe_empr_details eed on eed.empr_master_fk=em.pk and eed.active=1 and em.active=1
inner join empe_reg_details erd on eed.empe_reg_details_fk=erd.pk and erd.active=1
Inner Join benefit_accident_report bar on bar.empe_reg_details_fk=erd.pk
Inner Join benefit_tdb_od_det btd on btd.benefit_accident_report_fk=bar.pk
Inner Join task_details td on td.table_ref_key=btd.pk and td.active = 1
inner join tbllocation tbl on tbl.pk=erd.branch_office_fk and tbl.active='Yes' #and tbl.pk=1121
inner join tbllocation tbl1 on tbl1.pk=tbl.Reporting_Office and tbl1.active='Yes' and tbl1.pk=1120
where em.empr_code='63001048670000606'
group by erd.empe_ip_number,erd.empe_name,em.empr_code,
date(eed.appointment_date),date(erd.created_datetime);

IM3226409 (New Incident - Generation of Defaulter list pertaining to RO Ahmedabad in the required format)

use esicinsurance;
select em.empr_code as employercode,efd.fact_estab_name as Nameoftheemployer,tl.location_name as Branchoffice,
tbl.location_name as Inspectiondivision,concat(ecd.employer_address1,ecd.employer_address2,ecd.employer_address3) as address,
rsm.description as registrationstatus,ecd.email as Email,
ifnull(ecd.mobile,ecd.phone_number) as Mobile,td.District as District,
concat(rdl.defaulting_year,',',rdl.defaulting_month) as periodofnoncompliance,
esd.stkh_name as Nameoftheprincipalemployer,esd.stkh_present_address as Residentialaddress from empr_master em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1 and em.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
inner join registration_status_master rsm on rsm.pk=em.registration_status_fk 
inner join  tbldistrict td on ecd.district_fk=td.pk and td.active='Yes'
inner join revenue_defaulter_list rdl on rdl.empr_master_fk=em.pk and rdl.status in (1,2)
inner join empr_stkh_details esd on esd.empr_master_fk=em.pk and esd.active=1
inner join tbllocation tl on tl.pk=em.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=em.inspection_division_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active='Yes'
where tbl1.pk=715
group by em.empr_code,efd.fact_estab_name

union 

select em.sub_code as employercode,efd.fact_estab_name as Nameoftheemployer,tl.location_name as Branchoffice,
tbl.location_name as Inspectiondivision,concat(ecd.employer_address1,ecd.employer_address2,ecd.employer_address3) as address,
rsm.description as registrationstatus,ecd.email as Email,
ifnull(ecd.mobile,ecd.phone_number) as Mobile,td.District as District,
concat(rdl.defaulting_year,',',rdl.defaulting_month) as periodofnoncompliance,
esd.stkh_name as Nameoftheprincipalemployer,esd.stkh_present_address as Residentialaddress from empr_subunit_details em
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1 and em.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
inner join registration_status_master rsm on rsm.pk=em.reg_status_fk 
inner join  tbldistrict td on ecd.district_fk=td.pk and td.active='Yes'
inner join revenue_defaulter_list rdl on rdl.empr_subunit_details_fk=em.pk and rdl.status in (1,2)
inner join empr_stkh_details esd on esd.empr_master_fk=em.pk and esd.active=1
inner join tbllocation tl on tl.pk=em.branch_office_fk and tl.active='Yes'
inner join tbllocation tbl on tbl.pk=em.inspection_division_fk and tbl.active='Yes'
inner join tbllocation tbl1 on tbl1.pk=tbl.reporting_office and tbl1.active='Yes'
where tbl1.pk=715 
group by em.sub_code,efd.fact_estab_name;

--> IM3255795 (Status of PAN & NIC code updation-reg) 

select l.Lin_Number as lin,
em.empr_code as employercode,
nd.NIC_Code as NICcode,
efd.fact_estab_name as Nameoftheemployer,
ecd.email as Email,
ifnull(ecd.mobile,ecd.phone_number) phone_number,em.active as statusofestablishment 
from empr_master em
inner join lindata l on l.empr_master_pk=em.pk 
inner join empr_nic_details nd on nd.empr_master_fk=em.pk 
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
where em.active=1
group by em.empr_code
union
select l.Lin_Number as lin,
em.sub_code as employercode,
nd.NIC_Code as NICcode,
efd.fact_estab_name as Nameoftheemployer,
ecd.email as Email,
ifnull(ecd.mobile,ecd.phone_number) phone_number,em.active as statusofestablishment 
from empr_subunit_details em
inner join lindata l on l.empr_master_pk=em.pk 
inner join empr_nic_details nd on nd.empr_master_fk=em.pk 
inner join empr_factory_details efd on efd.empr_master_fk=em.pk and efd.active=1
inner join empr_employer_cont_details ecd on ecd.empr_master_fk=em.pk and ecd.active=1
where em.active=1
group by em.sub_code;













